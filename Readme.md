 # Reuse - 剪贴板增强工具

  ## 一、简介

  Reuse 是一款基于 Python 和 PyQt5 开发的剪贴板增强工具。它允许用户方便地保存、搜索和快速访问之前复制的内容。该工具会将剪贴板历史记录保存到本地的 SQLite 数据库中，支持使用全局快捷键快速打开历史记录窗口，提供悬浮窗预览功能，方便用户查看完整内容，同时支持对历史记录进行删除、清空等操作。

  ## 二、功能特性

  1. **历史记录保存**：自动将剪贴板的内容保存到本地的 SQLite 数据库中，避免内容丢失。
  2. **搜索功能**：支持在历史记录中搜索关键词，快速定位所需内容。
  3. **悬浮窗预览**：鼠标悬停在历史记录上时，弹出悬浮窗显示完整内容，无需点击即可查看。
  4. 快捷键操作：
     - `Ctrl + Shift + Q`：全局快捷键，快速打开历史记录窗口。
     - `Esc`：关闭历史记录窗口。
  5. **内容复制与粘贴**：双击历史记录或按下回车键，即可将内容复制到剪贴板并粘贴到之前焦点位置。
  6. **记录管理**：支持删除单条历史记录和清空所有历史记录。
  7. **设置功能**：可设置历史记录的最大保存数量。

  ## 三、安装与运行

  ### 3.1 环境要求

  - Python 3.x
  - PyQt5
  - sqlite3
  - keyboard
  - win32api（仅适用于 Windows 系统）

  ### 3.2 安装依赖

  在命令行中执行以下命令安装所需的 Python 库：

  bash

  ```bash
  pip install PyQt5 keyboard pywin32
  ```

  ### 3.3 运行程序

  将代码保存为 reuse.py，并确保 `reuse.ico` 文件存在于同一目录下，然后在命令行中运行：

  bash

  ```bash
  python reuse.py
  ```

  ## 四、使用方法

  ### 4.1 启动与打开

  运行 reuse.py 后，系统托盘会显示一个图标。按下全局快捷键 `Ctrl + Shift + Q` 或双击系统托盘图标，即可打开历史记录窗口。

  ### 4.2 搜索记录

  在历史记录窗口的搜索框中输入关键词，工具会自动筛选出包含该关键词的历史记录。

  ### 4.3 预览内容

  将鼠标悬停在历史记录上，会弹出悬浮窗显示该记录的完整内容。若鼠标离开表格或预览框，预览框会在 300 毫秒后自动隐藏。

  ### 4.4 复制与粘贴

  双击历史记录或按下回车键，所选内容会被复制到剪贴板，并自动粘贴到之前焦点所在的位置。

  ### 4.5 删除记录

  在历史记录上右键单击，选择 “删除” 即可删除该条记录。

  ### 4.6 清空历史记录

  在历史记录窗口中，可通过相应操作清空所有非置顶的剪贴板历史记录。

  ### 4.7 设置历史记录数量

  点击历史记录窗口中的 “设置” 按钮，输入最大保存记录数（范围为 20 - 500），点击 “确定” 即可更新设置。

  ## 五、注意事项

  1. 请确保 `reuse.ico` 文件存在于代码文件的同一目录下，否则将使用默认的系统托盘图标。
  2. 该工具目前仅支持 Windows 系统，部分功能依赖于 Windows API。

  ## 六、代码结构

  ### 6.1 `WorkerSignals` 类

  用于定义信号，目前仅定义了 `show_window` 信号。

  ### 6.2 `PreviewDialog` 类

  负责实现预览悬浮窗的功能，宽度与主窗口一致，高度会根据内容自适应调整。

  ### 6.3 `ReuseDatabase` 类

  管理剪贴板历史记录的数据库，包含以下主要方法：

  - `create_table`：创建存储剪贴板记录的数据库表。
  - `save_clip`：保存新的剪贴板内容。
  - `get_all_clips`：获取所有的剪贴板记录。
  - `search_clips`：根据关键词搜索剪贴板记录。
  - `delete_clip`：删除指定 ID 的记录。
  - `clear_all`：清空所有记录（保留置顶项）。
  - `set_limit`：设置历史记录的最大数量并保留最新记录。
  - `update_clip_as_latest`：将指定 ID 的内容更新为最新记录。

  ### 6.4 `ReuseHistoryWindow` 类

  剪贴板历史记录的主窗口，包含以下主要功能：

  - 初始化用户界面，包括搜索框、历史表格等。
  - 处理搜索、刷新、复制粘贴等操作。
  - 实现悬浮窗预览功能。
  - 支持快捷键操作和右键菜单。

  ## 七、贡献与反馈

  如果您在使用过程中发现任何问题或有改进建议，欢迎在 GitHub 上提交 issue 或 pull request。

  ## 八、许可证

  本项目采用 [MIT 许可证](https://opensource.org/licenses/MIT)。